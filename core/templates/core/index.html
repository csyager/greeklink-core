{% extends 'core/base.html' %}
{% block content %}
<script>
    $(document).ready(function() {
        jQuery.fn.carousel.Constructor.TRANSITION_DURATION = 2000
    });
</script>
<style>
    .carousel-inner .carousel-item {
        transition: -webkit-transform 2s ease;
        transition: transform 2s ease;
        transition: transform 2s ease, -webkit-transform 2s ease;
    }
</style>

{% load static %}
<br>
<div class="container" style="width: 90%; max-width: 2000px">
    <h1 class="display-4">Welcome, {{ user.get_short_name }}</h1>
    <p class="lead">{{ settings.organization_name }}</p>
    <br>
    <div class="row">
        <div class="col-lg-9">
            <h2>Announcements</h2>
                <div class='row title-row my-1'>
                    <div class='col-12 py-1'>
                        <nav aria-label="Page navigation">
                            <ul class="pagination float-left pagination-sm">
                                <li class="page-item active">
                                    <span class="page-link">Recent</span>
                                </li>
                                <li class ="page-item"><a class ="page-link" href="/all_announcements">All Announcements</a></li> 
                            </ul>
                        </nav>
                    </div>
                </div>
            <ul class="list-group">
                {% for announcement in announcements %}
                <li class="list-group-item">
                    <b><a href="{{ announcement.target }}">{{ announcement.title }}</a></b> - {{ announcement.user }} 
                {% if user.is_superuser %}
                <a href="removeAnnouncement{{ announcement.id }}" class="btn btn-danger btn-sm float-right">Remove</a>
                {% endif %} 
                    <br>
                    {{ announcement.body }}
                </li>
                
                {% endfor %}
            </ul><br>
                {% if request.user.is_superuser %}
            <button class="btn btn-primary" data-toggle="modal" data-target="#announcementModal">Add Announcement</button>
          <!-- Modal -->
            <div class="modal fade" id="announcementModal" tabindex="-1" role="dialog" aria-labelledby="announcementModal" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title" id="announcementModalLabel">Add Announcement</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form method="post" action="add_announcement">
                                {% csrf_token %}
                                {% load crispy_forms_tags %}
                                {{ announcement_form.title|as_crispy_field }}
                                {{ announcement_form.target|as_crispy_field }}
                                {{ announcement_form.body|as_crispy_field }}

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary">Save changes</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    <br>
</div>
{% endblock %}
